<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Pesquisa de Atendimento — IPASGO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; background:#f7f7f8; }
    .wrap { max-width: 640px; margin: 24px auto; background:#fff; padding:24px; border-radius:16px; box-shadow:0 8px 24px rgba(0,0,0,.06); }
    h1 { font-size: 22px; margin: 0 0 4px; }
    .sub { color:#666; margin:0 0 16px; font-size:14px; }
    label { display:block; margin:14px 0 6px; font-weight:600; }
    input, textarea, select { width:100%; padding:12px; border:1px solid #ddd; border-radius:10px; font-size:16px; }
    textarea{ min-height:110px; resize:vertical; }
    .row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .btn { margin-top:16px; width:100%; padding:14px; font-weight:700; border:0; border-radius:12px; background:#0a7f58; color:#fff; cursor:pointer; }
    .btn:disabled { background:#9ac9b7; cursor:not-allowed; }
    .muted { color:#666; font-size:12px; margin-top:10px; }
    .error { color:#b00020; font-size:14px; margin-top:8px; display:none; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Pesquisa de Atendimento</h1>
    <p class="sub">Ajude a melhorar nosso atendimento. Leva menos de 1 minuto.</p>

    <form id="form" method="post" action="FLOW_URL_AQUI" accept-charset="utf-8">
      <!-- atendente vem por parâmetro na URL e vai escondido -->
      <input type="hidden" name="AtendenteID" id="AtendenteID">
      <!-- honeypot anti-spam (não preencher) -->
      <input type="text" name="website" id="website" style="display:none" tabindex="-1" autocomplete="off">

      <label for="Nome">Nome</label>
      <input type="text" name="Nome" id="Nome" required>

      <div class="row">
        <div>
          <label for="CPF">CPF</label>
          <input type="text" name="CPF" id="CPF" placeholder="000.000.000-00" required>
        </div>
        <div>
          <label for="Telefone">Telefone</label>
          <input type="text" name="Telefone" id="Telefone" placeholder="(62) 99999-9999">
        </div>
      </div>

      <label for="Email">E-mail</label>
      <input type="email" name="Email" id="Email" placeholder="seuemail@exemplo.com">

      <label for="Nota">Nota (0 a 5)</label>
      <select name="Nota" id="Nota" required>
        <option value="5" selected>5 - Excelente</option>
        <option value="4">4 - Boa</option>
        <option value="3">3 - Regular</option>
        <option value="2">2 - Ruim</option>
        <option value="1">1 - Muito ruim</option>
        <option value="0">0 - Péssima</option>
      </select>

      <label for="Descricao">Descreva sua experiência</label>
      <textarea name="Descricao" id="Descricao" placeholder="Conte algo que te chamou atenção (positivo ou negativo)"></textarea>

      <label>
        <input type="checkbox" id="lgpd" required>
        Li e concordo com o Aviso de Privacidade.
      </label>

      <div class="error" id="erro">Preencha os campos obrigatórios e tente novamente.</div>
      <button class="btn" id="enviar" type="submit">Enviar avaliação</button>
      <p class="muted">IPASGO — Obrigado pela sua colaboração!</p>
    </form>
  </div>

  <script>
    // Lê ?atendente=M0001 e injeta no hidden
    const params = new URLSearchParams(location.search);
    const at = (params.get('atendente') || '').trim();
    document.getElementById('AtendenteID').value = at;

    // Validação mínima de CPF (somente dígitos/11 chars) e LGPD
    function onlyDigits(s){ return (s || '').replace(/\D+/g,''); }
    const form = document.getElementById('form');
    const cpf = document.getElementById('CPF');
    const lgpd = document.getElementById('lgpd');
    const erro = document.getElementById('erro');
    const enviar = document.getElementById('enviar');

    form.addEventListener('submit', function(e){
      // honeypot
      if (document.getElementById('website').value) { e.preventDefault(); return false; }
      // atendente obrigatório
      if (!at) { e.preventDefault(); erro.style.display='block'; return false; }
      // CPF mínimo (deixe o cálculo DV no Flow, aqui só formato)
      const c = onlyDigits(cpf.value);
      if (c.length !== 11) { e.preventDefault(); erro.style.display='block'; return false; }
      // LGPD marcado
      if (!lgpd.checked) { e.preventDefault(); erro.style.display='block'; return false; }
      erro.style.display='none';
      // Dica visual
      enviar.disabled = true; enviar.textContent = 'Enviando...';
      // Deixa o navegador fazer POST nativo e seguir o redirecionamento 302 do Flow
    });
  </script>
</body>
</html>
